{"ast":null,"code":"var _jsxFileName = \"/Users/jaitrasaketh/Documents/Development/Multi Object Tracking/GUI/frontend/annotation-tool/src/components/VideoPlayer.js\";\nimport React, { useRef, useState, useEffect } from 'react';\nimport './VideoPlayer.css';\nfunction VideoPlayer({\n  csvFile\n}) {\n  const [videoSrc, setVideoSrc] = useState(null);\n  const [frameImage, setFrameImage] = useState(null); // Frame image fetched from backend\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [editMode, setEditMode] = useState(null); // 'redraw' or 'edit-id'\n  const [showIdPopup, setShowIdPopup] = useState(false);\n  const [csvUploaded, setCsvUploaded] = useState(false);\n  const [currentId, setCurrentId] = useState(\"\");\n  const [newId, setNewId] = useState(\"\");\n  const [currentFrame, setCurrentFrame] = useState(0);\n  const [drawing, setDrawing] = useState(false);\n  const [bbox, setBbox] = useState(null); // Stores bounding box coordinates\n  const canvasRef = useRef(null);\n  const frameRate = 30;\n  useEffect(() => {\n    setCsvUploaded(csvFile);\n  }, [csvFile]);\n\n  // useEffect(() => {\n  //   if (videoSrc) fetchFrame(currentFrame); // Fetch the initial frame when video is loaded\n  // }, [videoSrc]);\n\n  useEffect(() => {\n    if (currentFrame >= 0) {\n      fetchFrame(currentFrame);\n    }\n  }, [currentFrame]);\n  const handleVideoUpload = async event => {\n    const file = event.target.files[0];\n    if (file && file.type.startsWith('video/')) {\n      const formData = new FormData();\n      formData.append('file', file);\n      try {\n        const response = await fetch('http://localhost:5000/upload_video', {\n          method: 'POST',\n          body: formData\n        });\n        const result = await response.json();\n        if (result.status === 'success') {\n          setVideoSrc(URL.createObjectURL(file));\n          setProgress(0);\n          setIsPlaying(false);\n        } else {\n          alert(result.message);\n        }\n      } catch (error) {\n        console.error('Error uploading video:', error);\n      }\n    } else {\n      alert('Please upload a valid video file.');\n    }\n  };\n  const fetchFrame = async frameIdx => {\n    try {\n      const response = await fetch(`http://localhost:5000/get_frame/${frameIdx}`);\n      if (response.ok) {\n        const blob = await response.blob();\n        setFrameImage(URL.createObjectURL(blob));\n      } else {\n        console.error('Failed to fetch frame');\n      }\n    } catch (error) {\n      console.error('Error fetching frame:', error);\n    }\n  };\n  const togglePlayPause = () => {\n    if (isPlaying) {\n      setIsPlaying(false);\n    } else {\n      setIsPlaying(true);\n      playVideo();\n    }\n  };\n  const playVideo = async () => {\n    while (isPlaying) {\n      await fetchFrame(currentFrame);\n      setCurrentFrame(prevFrame => prevFrame + 1);\n      const newProgress = (currentFrame + 1) / (frameRate * 10) * 100; // Assuming 10 seconds of video\n      setProgress(newProgress);\n      if (newProgress >= 100) {\n        setIsPlaying(false);\n        break;\n      }\n      await new Promise(resolve => setTimeout(resolve, 1000 / frameRate)); // Simulate frame rate\n    }\n  };\n  const handleSliderChange = event => {\n    const newProgress = event.target.value;\n    setProgress(newProgress);\n    const newFrame = Math.floor(newProgress / 100 * (frameRate * 10)); // Assuming 10 seconds of video\n    setCurrentFrame(newFrame);\n    fetchFrame(newFrame);\n  };\n  const handleEditOptionChange = event => {\n    if (!csvUploaded) {\n      alert('Please upload a CSV file before editing.');\n      return;\n    }\n    const selectedOption = event.target.value;\n    if (selectedOption === 'redraw') {\n      handleRedrawBoundingBox();\n    } else if (selectedOption === 'edit-id') {\n      handleEditId();\n    }\n  };\n  const handleRedrawBoundingBox = () => {\n    setEditMode('redraw');\n    setIsPlaying(false);\n  };\n  const handleEditId = () => {\n    setEditMode('edit-id');\n    setShowIdPopup(true);\n    setIsPlaying(false);\n  };\n  const handleMouseDown = e => {\n    if (editMode === 'redraw') {\n      const rect = canvasRef.current.getBoundingClientRect();\n      setBbox({\n        x1: e.clientX - rect.left,\n        y1: e.clientY - rect.top,\n        x2: null,\n        y2: null\n      });\n      setDrawing(true);\n    }\n  };\n  const handleMouseMove = e => {\n    if (drawing && editMode === 'redraw') {\n      const rect = canvasRef.current.getBoundingClientRect();\n      setBbox(prevBbox => ({\n        ...prevBbox,\n        x2: e.clientX - rect.left,\n        y2: e.clientY - rect.top\n      }));\n    }\n  };\n  const handleMouseUp = () => {\n    setDrawing(false);\n    console.log(\"Bounding box:\", bbox);\n  };\n  const handleSaveId = async () => {\n    try {\n      const response = await fetch(`http://localhost:5000/update-id`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          currentFrame: currentFrame,\n          currentId: currentId,\n          newId: newId\n        })\n      });\n      if (response.ok) {\n        console.log(\"ID updated successfully\");\n      } else {\n        console.error(\"Failed to update ID\");\n      }\n    } catch (error) {\n      console.error(\"Error updating ID:\", error);\n    }\n    setShowIdPopup(false);\n    setEditMode(null);\n    setCurrentId(\"\");\n    setNewId(\"\");\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"video-player\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 5\n    }\n  }, !videoSrc && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"label\", {\n    htmlFor: \"video-upload\",\n    className: \"upload-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 11\n    }\n  }, \"Upload Video\"), /*#__PURE__*/React.createElement(\"input\", {\n    id: \"video-upload\",\n    type: \"file\",\n    accept: \"video/*\",\n    style: {\n      display: 'none'\n    },\n    onChange: handleVideoUpload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 11\n    }\n  })), videoSrc && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: 'relative',\n      width: '100%'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 9\n    }\n  }, frameImage && /*#__PURE__*/React.createElement(\"img\", {\n    src: frameImage,\n    alt: `Frame ${currentFrame}`,\n    style: {\n      width: '100%',\n      position: 'relative'\n    },\n    onMouseDown: handleMouseDown,\n    onMouseMove: handleMouseMove,\n    onMouseUp: handleMouseUp,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 13\n    }\n  }), bbox && bbox.x2 && bbox.y2 && /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      position: 'absolute',\n      border: '2px solid blue',\n      left: Math.min(bbox.x1, bbox.x2),\n      top: Math.min(bbox.y1, bbox.y2),\n      width: Math.abs(bbox.x2 - bbox.x1),\n      height: Math.abs(bbox.y2 - bbox.y1)\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"controls\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: togglePlayPause,\n    className: \"upload-btn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 13\n    }\n  }, isPlaying ? 'Pause' : 'Play'), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"range\",\n    min: \"0\",\n    max: \"100\",\n    value: progress,\n    onChange: handleSliderChange,\n    className: \"timeline-slider\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    className: \"frame-display\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 13\n    }\n  }, \"Frame: \", currentFrame)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"save-download\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"select\", {\n    onChange: handleEditOptionChange,\n    className: \"edit-dropdown\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 15\n    }\n  }, \"Select Edit Option\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"redraw\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 15\n    }\n  }, \"Redraw Bounding Boxes\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"edit-id\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 15\n    }\n  }, \"Edit ID\")), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"save-btn\",\n    onClick: handleSaveId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 13\n    }\n  }, \"Save\"))), showIdPopup && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"id-popup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 11\n    }\n  }, \"Update ID\"), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Current ID\",\n    value: currentId,\n    onChange: e => setCurrentId(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"New ID\",\n    value: newId,\n    onChange: e => setNewId(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleSaveId,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 11\n    }\n  }, \"Save ID\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => {\n      setShowIdPopup(false);\n      setEditMode(null);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 11\n    }\n  }, \"Close\")));\n}\nexport default VideoPlayer;","map":{"version":3,"names":["React","useRef","useState","useEffect","VideoPlayer","csvFile","videoSrc","setVideoSrc","frameImage","setFrameImage","isPlaying","setIsPlaying","progress","setProgress","editMode","setEditMode","showIdPopup","setShowIdPopup","csvUploaded","setCsvUploaded","currentId","setCurrentId","newId","setNewId","currentFrame","setCurrentFrame","drawing","setDrawing","bbox","setBbox","canvasRef","frameRate","fetchFrame","handleVideoUpload","event","file","target","files","type","startsWith","formData","FormData","append","response","fetch","method","body","result","json","status","URL","createObjectURL","alert","message","error","console","frameIdx","ok","blob","togglePlayPause","playVideo","prevFrame","newProgress","Promise","resolve","setTimeout","handleSliderChange","value","newFrame","Math","floor","handleEditOptionChange","selectedOption","handleRedrawBoundingBox","handleEditId","handleMouseDown","e","rect","current","getBoundingClientRect","x1","clientX","left","y1","clientY","top","x2","y2","handleMouseMove","prevBbox","handleMouseUp","log","handleSaveId","headers","JSON","stringify","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","Fragment","htmlFor","id","accept","style","display","onChange","position","width","src","alt","onMouseDown","onMouseMove","onMouseUp","border","min","abs","height","onClick","max","placeholder"],"sources":["/Users/jaitrasaketh/Documents/Development/Multi Object Tracking/GUI/frontend/annotation-tool/src/components/VideoPlayer.js"],"sourcesContent":["import React, { useRef, useState, useEffect } from 'react';\nimport './VideoPlayer.css';\n\nfunction VideoPlayer({ csvFile }) {\n  const [videoSrc, setVideoSrc] = useState(null);\n  const [frameImage, setFrameImage] = useState(null); // Frame image fetched from backend\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [editMode, setEditMode] = useState(null); // 'redraw' or 'edit-id'\n  const [showIdPopup, setShowIdPopup] = useState(false);\n  const [csvUploaded, setCsvUploaded] = useState(false);\n  const [currentId, setCurrentId] = useState(\"\");\n  const [newId, setNewId] = useState(\"\");\n  const [currentFrame, setCurrentFrame] = useState(0);\n  const [drawing, setDrawing] = useState(false);\n  const [bbox, setBbox] = useState(null); // Stores bounding box coordinates\n  const canvasRef = useRef(null);\n\n  const frameRate = 30;\n\n  useEffect(() => {\n    setCsvUploaded(csvFile);\n  }, [csvFile]);\n\n  // useEffect(() => {\n  //   if (videoSrc) fetchFrame(currentFrame); // Fetch the initial frame when video is loaded\n  // }, [videoSrc]);\n\n  useEffect(() => {\n    if (currentFrame >= 0) {\n      fetchFrame(currentFrame);\n    }\n  }, [currentFrame]);\n  \n\n  const handleVideoUpload = async (event) => {\n    const file = event.target.files[0];\n    if (file && file.type.startsWith('video/')) {\n      const formData = new FormData();\n      formData.append('file', file);\n\n      try {\n        const response = await fetch('http://localhost:5000/upload_video', {\n          method: 'POST',\n          body: formData,\n        });\n\n        const result = await response.json();\n        if (result.status === 'success') {\n          setVideoSrc(URL.createObjectURL(file));\n          setProgress(0);\n          setIsPlaying(false);\n        } else {\n          alert(result.message);\n        }\n      } catch (error) {\n        console.error('Error uploading video:', error);\n      }\n    } else {\n      alert('Please upload a valid video file.');\n    }\n  };\n\n  const fetchFrame = async (frameIdx) => {\n    try {\n      const response = await fetch(`http://localhost:5000/get_frame/${frameIdx}`);\n      if (response.ok) {\n        const blob = await response.blob();\n        setFrameImage(URL.createObjectURL(blob));\n      } else {\n        console.error('Failed to fetch frame');\n      }\n    } catch (error) {\n      console.error('Error fetching frame:', error);\n    }\n  };\n\n  const togglePlayPause = () => {\n    if (isPlaying) {\n      setIsPlaying(false);\n    } else {\n      setIsPlaying(true);\n      playVideo();\n    }\n  };\n\n  const playVideo = async () => {\n    while (isPlaying) {\n      await fetchFrame(currentFrame);\n      setCurrentFrame((prevFrame) => prevFrame + 1);\n      const newProgress = ((currentFrame + 1) / (frameRate * 10)) * 100; // Assuming 10 seconds of video\n      setProgress(newProgress);\n\n      if (newProgress >= 100) {\n        setIsPlaying(false);\n        break;\n      }\n      await new Promise((resolve) => setTimeout(resolve, 1000 / frameRate)); // Simulate frame rate\n    }\n  };\n\n  const handleSliderChange = (event) => {\n    const newProgress = event.target.value;\n    setProgress(newProgress);\n    const newFrame = Math.floor((newProgress / 100) * (frameRate * 10)); // Assuming 10 seconds of video\n    setCurrentFrame(newFrame);\n    fetchFrame(newFrame);\n  };\n\n  const handleEditOptionChange = (event) => {\n    if (!csvUploaded) {\n      alert('Please upload a CSV file before editing.');\n      return;\n    }\n\n    const selectedOption = event.target.value;\n    if (selectedOption === 'redraw') {\n      handleRedrawBoundingBox();\n    } else if (selectedOption === 'edit-id') {\n      handleEditId();\n    }\n  };\n\n  const handleRedrawBoundingBox = () => {\n    setEditMode('redraw');\n    setIsPlaying(false);\n  };\n\n  const handleEditId = () => {\n    setEditMode('edit-id');\n    setShowIdPopup(true);\n    setIsPlaying(false);\n  };\n\n  const handleMouseDown = (e) => {\n    if (editMode === 'redraw') {\n      const rect = canvasRef.current.getBoundingClientRect();\n      setBbox({\n        x1: e.clientX - rect.left,\n        y1: e.clientY - rect.top,\n        x2: null,\n        y2: null,\n      });\n      setDrawing(true);\n    }\n  };\n\n  const handleMouseMove = (e) => {\n    if (drawing && editMode === 'redraw') {\n      const rect = canvasRef.current.getBoundingClientRect();\n      setBbox((prevBbox) => ({\n        ...prevBbox,\n        x2: e.clientX - rect.left,\n        y2: e.clientY - rect.top,\n      }));\n    }\n  };\n\n  const handleMouseUp = () => {\n    setDrawing(false);\n    console.log(\"Bounding box:\", bbox);\n  };\n\n  const handleSaveId = async () => {\n    try {\n      const response = await fetch(`http://localhost:5000/update-id`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          currentFrame: currentFrame,\n          currentId: currentId,\n          newId: newId,\n        }),\n      });\n\n      if (response.ok) {\n        console.log(\"ID updated successfully\");\n      } else {\n        console.error(\"Failed to update ID\");\n      }\n    } catch (error) {\n      console.error(\"Error updating ID:\", error);\n    }\n\n    setShowIdPopup(false);\n    setEditMode(null);\n    setCurrentId(\"\");\n    setNewId(\"\");\n  };\n\n  return (\n    <div className=\"video-player\">\n      {!videoSrc && (\n        <>\n          <label htmlFor=\"video-upload\" className=\"upload-btn\">Upload Video</label>\n          <input\n            id=\"video-upload\"\n            type=\"file\"\n            accept=\"video/*\"\n            style={{ display: 'none' }}\n            onChange={handleVideoUpload}\n          />\n        </>\n      )}\n\n      {videoSrc && (\n        <div style={{ position: 'relative', width: '100%' }}>\n          {frameImage && (\n            <img\n              src={frameImage}\n              alt={`Frame ${currentFrame}`}\n              style={{ width: '100%', position: 'relative' }}\n              onMouseDown={handleMouseDown}\n              onMouseMove={handleMouseMove}\n              onMouseUp={handleMouseUp}\n            />\n          )}\n\n          {bbox && bbox.x2 && bbox.y2 && (\n            <div\n              style={{\n                position: 'absolute',\n                border: '2px solid blue',\n                left: Math.min(bbox.x1, bbox.x2),\n                top: Math.min(bbox.y1, bbox.y2),\n                width: Math.abs(bbox.x2 - bbox.x1),\n                height: Math.abs(bbox.y2 - bbox.y1),\n              }}\n            />\n          )}\n\n          <div className=\"controls\">\n            <button onClick={togglePlayPause} className=\"upload-btn\">\n              {isPlaying ? 'Pause' : 'Play'}\n            </button>\n\n            <input\n              type=\"range\"\n              min=\"0\"\n              max=\"100\"\n              value={progress}\n              onChange={handleSliderChange}\n              className=\"timeline-slider\"\n            />\n            <span className=\"frame-display\">Frame: {currentFrame}</span>\n          </div>\n\n          <div className=\"save-download\">\n            <select onChange={handleEditOptionChange} className=\"edit-dropdown\">\n              <option value=\"\">Select Edit Option</option>\n              <option value=\"redraw\">Redraw Bounding Boxes</option>\n              <option value=\"edit-id\">Edit ID</option>\n            </select>\n\n            <button className=\"save-btn\" onClick={handleSaveId}>Save</button>\n          </div>\n        </div>\n      )}\n\n      {showIdPopup && (\n        <div className=\"id-popup\">\n          <h3>Update ID</h3>\n          <input\n            type=\"text\"\n            placeholder=\"Current ID\"\n            value={currentId}\n            onChange={(e) => setCurrentId(e.target.value)}\n          />\n          <input\n            type=\"text\"\n            placeholder=\"New ID\"\n            value={newId}\n            onChange={(e) => setNewId(e.target.value)}\n          />\n          <button onClick={handleSaveId}>Save ID</button>\n          <button onClick={() => { setShowIdPopup(false); setEditMode(null); }}>Close</button>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default VideoPlayer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}